  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "shops" /*application='RailsGateway'*/[0m
  [1m[35m (47.0ms)[0m  [1m[35mCREATE TABLE "shops" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "domain" varchar NOT NULL, "access_token" varchar NOT NULL, "scope" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL) /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE UNIQUE INDEX "index_shops_on_domain" ON "shops" ("domain") /*application='RailsGateway'*/[0m
  [1m[35m (0.0ms)[0m  [1m[35mDROP TABLE IF EXISTS "request_logs" /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "request_logs" ("id" integer PRIMARY KEY AUTOINCREMENT NOT NULL, "store_id" varchar NOT NULL, "question" text NOT NULL, "response" text, "success" boolean DEFAULT TRUE, "error_message" varchar, "response_time_ms" integer, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL) /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE INDEX "index_request_logs_on_store_id" ON "request_logs" ("store_id") /*application='RailsGateway'*/[0m
  [1m[35m (0.1ms)[0m  [1m[35mCREATE INDEX "index_request_logs_on_created_at" ON "request_logs" ("created_at") /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" varchar NOT NULL PRIMARY KEY) /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20241226000002) /*application='RailsGateway'*/[0m
  [1m[35m (0.1ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20241226000001); /*application='RailsGateway'*/[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" varchar NOT NULL PRIMARY KEY, "value" varchar, "created_at" datetime(6) NOT NULL, "updated_at" datetime(6) NOT NULL) /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1 /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2025-12-26 05:47:02.675647', '2025-12-26 05:47:02.675650') RETURNING "key" /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1 /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1 /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', 'aacb2c4c4384bb951814d41fb8d9b4305e7eacb8', '2025-12-26 05:47:02.682782', '2025-12-26 05:47:02.682786') RETURNING "key" /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT * FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' ORDER BY "ar_internal_metadata"."key" ASC LIMIT 1 /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC /*application='RailsGateway'*/[0m
  [1m[36mActiveRecord::SchemaMigration Load (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC /*application='RailsGateway'*/[0m
Started GET "/" for 127.0.0.1 at 2025-12-26 11:20:31 +0530
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC /*application='RailsGateway'*/[0m
Processing by Rails::WelcomeController#index as HTML
  Rendering C:/Ruby32-x64/lib/ruby/gems/3.2.0/gems/railties-8.1.1/lib/rails/templates/rails/welcome/index.html.erb
  Rendered C:/Ruby32-x64/lib/ruby/gems/3.2.0/gems/railties-8.1.1/lib/rails/templates/rails/welcome/index.html.erb (Duration: 1.0ms | GC: 0.0ms)
Completed 200 OK in 346ms (Views: 74.1ms | ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


Started GET "/icon.png" for 127.0.0.1 at 2025-12-26 11:20:32 +0530
  
ActionController::RoutingError (No route matches [GET] "/icon.png"):
  
Started GET "/icon.png" for 127.0.0.1 at 2025-12-26 11:20:33 +0530
  
ActionController::RoutingError (No route matches [GET] "/icon.png"):
  
Started GET "/favicon.ico" for ::1 at 2025-12-26 11:21:09 +0530
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:21:31 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"your-store.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store your-store.myshopify.com: What were my top selling products last week?
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
LoadError (cannot load such file -- httparty):
  
app/services/python_ai_service.rb:1:in `<main>'
app/controllers/api/v1/questions_controller.rb:19:in `create'
Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:23:05 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
Completed 500 Internal Server Error in 116ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
LoadError (cannot load such file -- httparty):
  
app/services/python_ai_service.rb:1:in `<main>'
app/controllers/api/v1/questions_controller.rb:19:in `create'
Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:24:56 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
Completed 500 Internal Server Error in 105ms (ActiveRecord: 0.0ms (0 queries, 0 cached) | GC: 0.0ms)


  
LoadError (cannot load such file -- httparty):
  
app/services/python_ai_service.rb:1:in `<main>'
app/controllers/api/v1/questions_controller.rb:19:in `create'
Started GET "/api/v1/questions" for ::1 at 2025-12-26 11:25:06 +0530
  
ActionController::RoutingError (No route matches [GET] "/api/v1/questions"):
  
[dotenv] Set [36mPYTHON_SERVICE_URL[0m, [36mSECRET_KEY_BASE[0m, [36mSHOPIFY_API_KEY[0m, [36mSHOPIFY_API_SECRET[0m, [36mSHOPIFY_REDIRECT_URI[0m
[dotenv] Loaded [33m.env[0m
Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:32:14 +0530
  [1m[36mActiveRecord::SchemaMigration Load (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC /*application='RailsGateway'*/[0m
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (2.2ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top selling products last week?', '{"error":"Failed to generate valid query after multiple attempts","details":"400 API key expired. Please renew the API key. [reason: \"API_KEY_INVALID\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"generativelanguage.googleapis.com\"\n}\n, locale: \"en-US\"\nmessage: \"API key expired. Please renew the API key.\"\n]","suggestion":"Try rephrasing your question or being more specific about the time range."}', TRUE, NULL, 3649, '2025-12-26 06:02:18.936498', '2025-12-26 06:02:18.936498') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (42.8ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 3919ms (Views: 0.2ms | ActiveRecord: 52.7ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:36:14 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (3.8ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top selling products last week?', '{"error":"Failed to generate valid query after multiple attempts","details":"400 API key expired. Please renew the API key. [reason: \"API_KEY_INVALID\"\ndomain: \"googleapis.com\"\nmetadata {\n  key: \"service\"\n  value: \"generativelanguage.googleapis.com\"\n}\n, locale: \"en-US\"\nmessage: \"API key expired. Please renew the API key.\"\n]","suggestion":"Try rephrasing your question or being more specific about the time range."}', TRUE, NULL, 3231, '2025-12-26 06:06:17.588778', '2025-12-26 06:06:17.588778') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 3246ms (Views: 0.3ms | ActiveRecord: 4.2ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:38:49 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (20.4ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top selling products last week?', '{"error":"Failed to generate valid query after multiple attempts","details":"[{''message'': \"Field ''shopifyqlQuery'' doesn''t exist on type ''QueryRoot''\", ''locations'': [{''line'': 3, ''column'': 15}], ''path'': [''query TableQuery'', ''shopifyqlQuery''], ''extensions'': {''code'': ''undefinedField'', ''typeName'': ''QueryRoot'', ''fieldName'': ''shopifyqlQuery''}}, {''message'': ''Variable $query is declared by TableQuery but not used'', ''locations'': [{''line'': 2, ''column'': 13}], ''path'': [''query TableQuery''], ''extensions'': {''code'': ''variableNotUsed'', ''variableName'': ''query''}}]","suggestion":"Try rephrasing your question or being more specific about the time range."}', TRUE, NULL, 26702, '2025-12-26 06:09:16.703716', '2025-12-26 06:09:16.703716') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (92.9ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 26825ms (Views: 0.4ms | ActiveRecord: 113.3ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:44:41 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (28.6ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top selling products last week?', '{"answer":"I was able to retrieve your store data, but had trouble analyzing it. Please try asking a more specific question.","intent":"sales_analysis","confidence":"low","cached":false}', TRUE, NULL, 4433, '2025-12-26 06:14:46.070959', '2025-12-26 06:14:46.070959') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (94.6ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 4584ms (Views: 0.2ms | ActiveRecord: 123.6ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:47:56 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top selling products last week?
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (20.2ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top selling products last week?', '{"answer":"It looks like I don''t have any sales data available from last week to identify your top-selling products. The current data shows no orders for that period.\n\nTo help you with this, please make sure the date range for the data extraction includes last week''s sales, or if you''ve recently started, ensure there are orders in your store. Once we have that information, I can definitely tell you which products were your best sellers!","intent":"sales_analysis","confidence":"high","cached":false}', TRUE, NULL, 5653, '2025-12-26 06:18:01.990859', '2025-12-26 06:18:01.990859') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 5686ms (Views: 0.1ms | ActiveRecord: 20.5ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:53:44 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"What were my top 5 selling products last week?"}
Processing question for store fry7xk-1v.myshopify.com: What were my top 5 selling products last week?
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (15.8ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'What were my top 5 selling products last week?', '{"answer":"It looks like I don''t have any order data from last week to analyze at the moment. The current data shows no sales records, so I can''t determine your top 5 selling products.\n\nTo help you with this, please ensure that the system has access to your recent order history. Once that data is available, I can quickly identify your best-performing products!","intent":"sales_analysis","confidence":"high","cached":false}', TRUE, NULL, 6742, '2025-12-26 06:23:51.757661', '2025-12-26 06:23:51.757661') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (40.6ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 6816ms (Views: 0.3ms | ActiveRecord: 56.5ms (1 query, 0 cached) | GC: 0.0ms)


Started POST "/api/v1/questions" for ::1 at 2025-12-26 11:53:59 +0530
Processing by Api::V1::QuestionsController#create as */*
  Parameters: {"store_id"=>"fry7xk-1v.myshopify.com", "question"=>"List all my products"}
Processing question for store fry7xk-1v.myshopify.com: List all my products
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN immediate TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mRequestLog Create (2.5ms)[0m  [1m[32mINSERT INTO "request_logs" ("store_id", "question", "response", "success", "error_message", "response_time_ms", "created_at", "updated_at") VALUES ('fry7xk-1v.myshopify.com', 'List all my products', '{"answer":"It looks like there are currently no products listed in your store.\n\nIf you''ve recently added products, there might be a slight delay, or perhaps they haven''t been published yet. Let me know if you''d like me to check again, or if you''ve recently made changes!","intent":"product_info","confidence":"high","cached":false}', TRUE, NULL, 4936, '2025-12-26 06:24:04.111401', '2025-12-26 06:24:04.111401') RETURNING "id" /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mCOMMIT TRANSACTION /*action='create',application='RailsGateway',controller='questions'*/[0m
  â†³ app/controllers/api/v1/questions_controller.rb:24:in `create'
Completed 200 OK in 4962ms (Views: 0.3ms | ActiveRecord: 2.8ms (1 query, 0 cached) | GC: 0.0ms)


